build:
  gpu: true
  cuda: "12.2"
  python_version: "3.10"

  # environment variables available inside the container
  environment:
    NUMPY_EXPERIMENTAL_ARRAY_FUNCTION: "1"

  system_packages:
    - ffmpeg
    - git
    - libsndfile1

  python_packages: []        # we install everything explicitly below

  run:
    - pip install numpy==1.26.4                           # ABIâ€‘compatible NumPy
    - pip install --extra-index-url https://download.pytorch.org/whl/cu121 \
        torch==2.2.2+cu121 torchaudio==2.2.2+cu121        # PyTorch wheels
    - pip install soundfile descript-audio-codec>=1.0.0 \
        huggingface_hub>=0.30.2 transformers>=4.39 \
        accelerate>=0.28 tqdm packaging typing_extensions # Dia runtime deps
    - pip install --no-deps git+https://github.com/nari-labs/dia.git  # Dia itself
    - pip install --upgrade "pydantic>=2.11.3"            # ensure BeforeValidator

predict: "predict.py:Predictor"
